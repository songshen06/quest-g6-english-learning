# 📱 Quest G6 PWA离线应用使用指南

## 🎯 PWA（Progressive Web App）简介

PWA是一种现代Web应用技术，结合了Web应用和原生应用的优势：

- ✅ **可安装**：像原生应用一样安装到设备
- ✅ **离线工作**：无需网络连接即可使用核心功能
- ✅ **快速启动**：比传统网页应用启动更快
- ✅ **自动更新**：后台自动检查并更新应用
- ✅ **推送通知**：支持系统级通知（未来功能）

## 🚀 安装PWA应用

### 方法一：浏览器自动提示
1. 在支持的浏览器（Chrome、Edge、Safari等）中访问应用
2. 当满足安装条件时，浏览器会自动显示安装提示
3. 点击"安装"或"添加到主屏幕"

### 方法二：手动安装
1. 在浏览器中访问应用
2. 点击地址栏右侧的安装图标（如果显示）
3. 或使用浏览器菜单中的"安装应用"选项

### 方法三：移动端安装
1. **iOS设备（Safari）**：
   - 访问应用
   - 点击分享按钮（底部工具栏）
   - 选择"添加到主屏幕"

2. **Android设备（Chrome）**：
   - 访问应用
   - 浏览器会自动显示安装横幅
   - 点击"安装应用"

## 📋 离线功能说明

### 🎵 音频文件缓存
- **首次访问**：自动缓存所有音频文件（978个MP3文件）
- **离线使用**：所有音频内容可离线播放
- **缓存策略**：优先使用缓存，有网络时自动更新

### 📚 课程内容缓存
- **课程数据**：所有42个模块的JSON内容自动缓存
- **离线学习**：完整的课程内容可离线访问
- **更新机制**：网络恢复时自动检查内容更新

### 🖼️ 界面资源缓存
- **界面文件**：HTML、CSS、JavaScript文件完全缓存
- **图标图片**：应用图标和界面图片自动缓存
- **字体资源**：Google字体缓存一年，确保离线显示效果

## 🔄 缓存策略详解

### 音频文件（mp3, wav）
```javascript
{
  handler: 'CacheFirst',
  cacheName: 'audio-cache',
  options: {
    maxEntries: 1000,    // 最多缓存1000个音频文件
    maxAgeSeconds: 2592000  // 缓存30天
  }
}
```

### 课程内容（json）
```javascript
{
  handler: 'CacheFirst',
  cacheName: 'content-cache',
  options: {
    maxEntries: 100,     // 最多缓存100个JSON文件
    maxAgeSeconds: 604800  // 缓存7天
  }
}
```

### 静态资源（js, css, html）
```javascript
{
  handler: 'CacheFirst',
  cacheName: 'static-cache',
  options: {
    maxEntries: 100,
    maxAgeSeconds: 86400  // 缓存24小时
  }
}
```

## 📱 PWA应用特性

### 应用图标
- **192x192**：安卓设备主屏幕图标
- **512x512**：应用商店和启动画面
- **自适应图标**：支持Android 8+自适应图标

### 应用信息
- **名称**：Quest G6 - 外研社英语学习系统
- **简称**：Quest G6
- **主题色**：#6366f1（蓝紫色）
- **显示模式**：standalone（独立应用模式）

### 快捷方式
- **四年级课程**：直接跳转到四年级学习页面
- **五年级课程**：直接跳转到五年级学习页面
- **更多快捷方式**：可在后续版本中添加

## 🔧 技术实现原理

### Service Worker
Service Worker是PWA的核心技术，它作为客户端代理，拦截网络请求：

1. **注册时机**：应用加载时自动注册
2. **激活策略**：新版本检测到时自动激活
3. **更新机制**：后台定期检查应用更新

### 缓存管理
使用Google Workbox库管理缓存：

```javascript
// 预缓存关键文件
workbox.precaching.precacheAndRoute([
  { url: '/index.html', revision: 'version-hash' },
  { url: '/main.js', revision: 'version-hash' },
  // ... 其他关键文件
])

// 运行时缓存策略
workbox.routing.registerRoute(
  /\.(?:mp3|wav)$/,
  new workbox.strategies.CacheFirst({
    cacheName: 'audio-cache'
  })
)
```

### 离线检测
应用提供离线状态检测和提示：

```javascript
window.addEventListener('online', () => {
  console.log('🌐 网络已连接')
  // 触发同步和更新检查
})

window.addEventListener('offline', () => {
  console.log('📵 网络已断开，使用离线模式')
  // 显示离线提示
})
```

## 🎯 使用建议

### 首次使用
1. **连接WiFi**：首次访问建议在WiFi环境下，以便下载所有资源
2. **完整浏览**：建议浏览所有年级和模块，确保内容完整缓存
3. **测试音频**：播放几个音频文件，确认音频缓存正常

### 日常使用
1. **定期联网**：建议每周联网一次，获取内容更新
2. **存储管理**：如果设备存储空间不足，可清除浏览器缓存重新下载
3. **版本更新**：应用会自动检测更新，可根据提示进行更新

### 故障排除
1. **音频无法播放**：检查应用权限，确认网络连接正常
2. **内容无法加载**：尝试刷新页面或重新安装应用
3. **离线功能异常**：清除浏览器数据，重新访问应用进行完整缓存

## 📊 缓存容量估算

### 资源类型及大小
- **音频文件**：978个 × 平均20KB = 约19.6MB
- **课程内容**：42个JSON × 平均50KB = 约2.1MB
- **界面资源**：JS + CSS = 约500KB
- **图片图标**：约200KB

### 总缓存大小
- **完整缓存**：约22.4MB
- **核心功能**：约5MB（不含音频）
- **推荐存储**：至少50MB可用空间

## 🚀 未来功能规划

### 即将推出的PWA功能
1. **离线进度同步**：离线学习进度在网络恢复时自动同步
2. **推送通知**：学习提醒和进度通知
3. **后台同步**：自动下载更新的课程内容
4. **文件管理**：手动管理缓存文件的下载和删除

### 高级功能
1. **离线测试**：完全离线的练习和测试功能
2. **本地存储**：更大量的本地内容存储
3. **多设备同步**：跨设备的进度和数据同步

---

**📱 开始使用**：访问 [应用地址](https://songshen06.github.io/quest-g6-english-learning/)，体验离线学习功能！

如有问题，请查看[故障排除](#故障排除)部分或联系技术支持。